---
layout: post
title: Windows > Wow6432 & registry redirection
categories: [Windows]
---

## the case	of wow6432
* the question is, running procmon, why 
    * if querying HKEY_CURRENT_USER, the node `wow6432` **HAS NOT** been queried
    * if querying HKEY_LOCAL_MACHINE, the node `wow6432` **HAS** been queried

## findings
* Registry: `HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node`
* The presence of the registry key `HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node` indicates that the system is running a 64-bit version of Windows.
* If a 32-bit application queries a registry key or value below `HKEY_LOCAL_MACHINE\SOFTWARE\$company`, it is automatically routed to the respective key or value below `HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\$company`.
* **REGISTRY REDIRECTION** is not a binary option 
    * it is not either present or not present
* Why? 
    * Sometimes you want both 32-bit and 64-bit applications to have the same "view" of (part of) the registry... 
    * in other cases you do want to keep them separate and you redirect to a dedicated wow6432 node
* That's why the specific keys affected by redirection are **DOCUMENTED**. 
* see <https://docs.microsoft.com/en-us/windows/win32/winprog64/shared-registry-keys>
* `HKEY_CURRENT_USER` itself is shared, as is `HKEY_CURRENT_USER\Software`
* However, `HKEY_CURRENT_USER\Software\Classes\CLSID`, which includes COM component registration data (which is necessarily 32/64 bit split) does perform redirection.
* `HKEY_LOCAL_MACHINE\Software\` is also redirected
* Or, to put it another way, if registry redirection was universal, you wouldn't need all of this convolution involving Wow6432Node, etc. 
* ...we would just have a 32-bit registry and a 64-bit registry.

### sources
* <https://docs.microsoft.com/en-us/windows/win32/sysinfo/32-bit-and-64-bit-application-data-in-the-registry>
* <https://stackoverflow.com/a/40169992/11082684>
* <https://docs.microsoft.com/en-us/windows/win32/winprog64/shared-registry-keys>